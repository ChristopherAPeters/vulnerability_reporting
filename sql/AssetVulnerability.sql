USE VULNMGMT_DB;
DROP TABLE IF EXISTS ASSETVULNERABILITY;
CREATE TABLE ASSETVULNERABILITY ( ASSET_ID int NOT NULL,
    VULNERABILITY_ID varchar(255),
    FIRST_SEEN date,
    LAST_SEEN date,
    PORT integer,
    StatusID integer,
    LABEL varchar(255),
    CONSTRAINT fk_assetID
        FOREIGN KEY (ASSET_ID)
          REFERENCES ASSETS(AssetID)
	  ON DELETE CASCADE,
          
    CONSTRAINT fk_vulnID
        FOREIGN KEY (VULNERABILITY_ID) REFERENCES VULNERABILITY(VulnerabilityID) 
	ON DELETE CASCADE,
    CONSTRAINT fk_statusID
	FOREIGN KEY (StatusID) REFERENCES STATUS(StatusID)
	ON DELETE CASCADE,
    PRIMARY KEY (ASSET_ID,VULNERABILITY_ID,PORT)

) ENGINE=INNODB;
